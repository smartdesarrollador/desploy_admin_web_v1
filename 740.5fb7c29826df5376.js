"use strict";(self.webpackChunkmy_primer_proy_angular=self.webpackChunkmy_primer_proy_angular||[]).push([[740],{6740:(M,u,s)=>{s.r(u),s.d(u,{BannerEditComponent:()=>q});var e=s(9212),d=s(6814),a=s(6223),m=s(8432),g=s(9231),_=s(553);function p(t,i){if(1&t&&(e.TgZ(0,"div",9)(1,"p"),e._uU(2),e.qZA()()),2&t){const n=e.oxw();e.xp6(2),e.Oqu(n.errorMessage)}}function f(t,i){if(1&t&&(e.TgZ(0,"div",10)(1,"p"),e._uU(2),e.qZA()()),2&t){const n=e.oxw();e.xp6(2),e.Oqu(n.successMessage)}}function b(t,i){1&t&&(e.TgZ(0,"div",11),e._UZ(1,"div",12),e.TgZ(2,"span",13),e._uU(3,"Cargando datos del banner..."),e.qZA()())}function x(t,i){if(1&t&&(e.TgZ(0,"p",43),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.hij(" ",n," ")}}function h(t,i){if(1&t&&(e.TgZ(0,"div",41),e.YNc(1,x,2,1,"p",42),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.obtenerErrores("titulo"))}}function v(t,i){if(1&t&&(e.TgZ(0,"p",43),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.hij(" ",n," ")}}function Z(t,i){if(1&t&&(e.TgZ(0,"div",41),e.YNc(1,v,2,1,"p",42),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.obtenerErrores("texto_boton"))}}function I(t,i){if(1&t&&(e.TgZ(0,"p",43),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.hij(" ",n," ")}}function T(t,i){if(1&t&&(e.TgZ(0,"div",41),e.YNc(1,I,2,1,"p",42),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.obtenerErrores("enlace_boton"))}}function E(t,i){if(1&t&&(e.TgZ(0,"p",43),e._uU(1),e.qZA()),2&t){const n=i.$implicit;e.xp6(1),e.hij(" ",n," ")}}function y(t,i){if(1&t&&(e.TgZ(0,"div",41),e.YNc(1,E,2,1,"p",42),e.qZA()),2&t){const n=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",n.obtenerErrores("orden"))}}function C(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(n);const r=e.oxw(3);return e.KtG(r.eliminarImagenSeleccionada())}),e.O4$(),e.TgZ(1,"svg",49),e._UZ(2,"path",50),e.qZA()()}}function w(t,i){if(1&t&&(e.TgZ(0,"div",44)(1,"div",45),e._UZ(2,"img",46),e.YNc(3,C,3,0,"button",47),e.qZA()()),2&t){const n=e.oxw(2);e.xp6(2),e.Q6J("src",n.previewImagen,e.LSH),e.xp6(1),e.Q6J("ngIf",n.imagenSeleccionada)}}function B(t,i){1&t&&(e.TgZ(0,"span",51),e.O4$(),e.TgZ(1,"svg",52),e._UZ(2,"circle",53)(3,"path",54),e.qZA(),e._uU(4," Guardando... "),e.qZA())}function A(t,i){1&t&&(e.TgZ(0,"span"),e._uU(1,"Guardar cambios"),e.qZA())}const c=(t,i)=>({"border-red-500":t,"border-gray-300":i});function U(t,i){if(1&t){const n=e.EpF();e.TgZ(0,"form",14),e.NdJ("ngSubmit",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.onSubmit())}),e.TgZ(1,"div",15)(2,"div",16)(3,"label",17),e._uU(4,"T\xedtulo del Banner *"),e.qZA(),e._UZ(5,"input",18),e.YNc(6,h,2,1,"div",19),e.qZA(),e.TgZ(7,"div",16)(8,"label",20),e._uU(9,"Descripci\xf3n"),e.qZA(),e._UZ(10,"textarea",21),e.qZA(),e.TgZ(11,"div")(12,"label",22),e._uU(13,"Texto del Bot\xf3n *"),e.qZA(),e._UZ(14,"input",23),e.YNc(15,Z,2,1,"div",19),e.qZA(),e.TgZ(16,"div")(17,"label",24),e._uU(18,"Enlace del Bot\xf3n *"),e.qZA(),e._UZ(19,"input",25),e.YNc(20,T,2,1,"div",19),e.qZA(),e.TgZ(21,"div")(22,"label",26),e._uU(23,"Orden *"),e.qZA(),e._UZ(24,"input",27),e.YNc(25,y,2,1,"div",19),e.qZA(),e.TgZ(26,"div")(27,"div",28),e._UZ(28,"input",29),e.TgZ(29,"label",30),e._uU(30,"Banner activo"),e.qZA()()(),e.TgZ(31,"div",16)(32,"label",31),e._uU(33,"Imagen del Banner"),e.qZA(),e.YNc(34,w,4,2,"div",32),e.TgZ(35,"div",33)(36,"input",34),e.NdJ("change",function(r){e.CHM(n);const l=e.oxw();return e.KtG(l.onFileChange(r))}),e.qZA(),e.TgZ(37,"p",35),e._uU(38," Selecciona una imagen para reemplazar la actual. Formatos admitidos: JPG, PNG (M\xe1x. 5MB) "),e.qZA()()()(),e.TgZ(39,"div",36)(40,"button",37),e.NdJ("click",function(){e.CHM(n);const r=e.oxw();return e.KtG(r.cancelar())}),e._uU(41," Cancelar "),e.qZA(),e.TgZ(42,"button",38),e.YNc(43,B,5,0,"span",39)(44,A,2,0,"span",40),e.qZA()()()}if(2&t){const n=e.oxw();e.Q6J("formGroup",n.bannerForm),e.xp6(5),e.Q6J("ngClass",e.WLB(13,c,n.esInvalido("titulo"),!n.esInvalido("titulo"))),e.xp6(1),e.Q6J("ngIf",n.esInvalido("titulo")),e.xp6(8),e.Q6J("ngClass",e.WLB(16,c,n.esInvalido("texto_boton"),!n.esInvalido("texto_boton"))),e.xp6(1),e.Q6J("ngIf",n.esInvalido("texto_boton")),e.xp6(4),e.Q6J("ngClass",e.WLB(19,c,n.esInvalido("enlace_boton"),!n.esInvalido("enlace_boton"))),e.xp6(1),e.Q6J("ngIf",n.esInvalido("enlace_boton")),e.xp6(4),e.Q6J("ngClass",e.WLB(22,c,n.esInvalido("orden"),!n.esInvalido("orden"))),e.xp6(1),e.Q6J("ngIf",n.esInvalido("orden")),e.xp6(9),e.Q6J("ngIf",n.previewImagen),e.xp6(8),e.Q6J("disabled",n.isLoading),e.xp6(1),e.Q6J("ngIf",n.isLoading),e.xp6(1),e.Q6J("ngIf",!n.isLoading)}}let q=(()=>{class t{constructor(){this.fb=(0,e.f3M)(a.qu),this.router=(0,e.f3M)(m.F0),this.route=(0,e.f3M)(m.gz),this.bannerService=(0,e.f3M)(g.Q),this.isLoading=!1,this.isLoadingData=!0,this.errorMessage=null,this.successMessage=null,this.currentBanner=null,this.imagenSeleccionada=null,this.previewImagen=null,this.imagenActual=null}ngOnInit(){this.inicializarFormulario(),this.cargarBanner()}inicializarFormulario(){this.bannerForm=this.fb.group({titulo:["",[a.kI.required,a.kI.maxLength(150)]],descripcion:[""],texto_boton:["",[a.kI.required,a.kI.maxLength(50)]],enlace_boton:["",[a.kI.required,a.kI.pattern("(https?://)?([\\da-z.-]+)\\.([a-z.]{2,6})[/\\w .-]*/?")]],orden:[0,[a.kI.required,a.kI.min(0)]],activo:[!0]})}cargarBanner(){this.route.params.subscribe(n=>{if(this.bannerId=+n.id,!this.bannerId||isNaN(this.bannerId))return this.errorMessage="ID de banner inv\xe1lido",void(this.isLoadingData=!1);this.bannerService.getBannerById(this.bannerId).subscribe({next:o=>{this.currentBanner=o,this.cargarDatosEnFormulario(o),this.isLoadingData=!1},error:o=>{console.error("Error al cargar el banner",o),this.errorMessage="No se pudo cargar la informaci\xf3n del banner. Por favor, int\xe9ntelo de nuevo.",this.isLoadingData=!1}})})}cargarDatosEnFormulario(n){this.bannerForm.patchValue({titulo:n.titulo,descripcion:n.descripcion,texto_boton:n.texto_boton,enlace_boton:n.enlace_boton,orden:n.orden,activo:n.activo}),this.imagenActual=n.imagen,this.previewImagen=this.obtenerUrlImagen(n.imagen)}onFileChange(n){const o=n.target;if(o.files&&o.files.length){const r=o.files[0];this.imagenSeleccionada=r;const l=new FileReader;l.onload=()=>{this.previewImagen=l.result},l.readAsDataURL(r)}}obtenerUrlImagen(n){return n.startsWith("http")?n:`${_.N.urlDominioApi}/${n}`}onSubmit(){Object.keys(this.bannerForm.controls).forEach(n=>{this.bannerForm.get(n)?.markAsTouched()}),this.isLoading=!0,this.errorMessage=null,this.bannerService.updateBanner(this.bannerId,this.bannerForm.value,this.imagenSeleccionada||void 0).subscribe({next:n=>{this.isLoading=!1,this.successMessage=`Banner "${n.titulo}" actualizado exitosamente.`,setTimeout(()=>{this.router.navigate(["/admin/banners"])},1500)},error:n=>{this.isLoading=!1,this.errorMessage="Error al actualizar el banner. Verifique los datos e intente nuevamente.",console.error("Error al actualizar banner:",n)}})}cancelar(){this.router.navigate(["/admin/banners"])}eliminarImagenSeleccionada(){this.imagenSeleccionada=null,this.previewImagen=this.imagenActual?this.obtenerUrlImagen(this.imagenActual):null;const n=document.getElementById("imagen");n&&(n.value="")}get f(){return this.bannerForm.controls}esInvalido(n){const o=this.bannerForm.get(n);return!!o&&o.invalid&&(o.dirty||o.touched)}obtenerErrores(n){const o=this.bannerForm.get(n),r=[];return o&&o.errors&&(o.dirty||o.touched)?(o.errors.required&&r.push("Este campo es obligatorio."),o.errors.maxlength&&r.push(`M\xe1ximo ${o.errors.maxlength.requiredLength} caracteres permitidos.`),o.errors.pattern&&r.push("Ingrese una URL v\xe1lida."),o.errors.min&&r.push(`El valor m\xednimo es ${o.errors.min.min}.`),r):r}static#e=this.\u0275fac=function(o){return new(o||t)};static#n=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-banner-edit"]],standalone:!0,features:[e.jDz],decls:11,vars:4,consts:[[1,"container","mx-auto","px-4","py-6"],[1,"bg-white","rounded-lg","shadow-md","p-6","max-w-4xl","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],[1,"px-4","py-2","bg-gray-200","text-gray-700","rounded","hover:bg-gray-300","transition","duration-200",3,"click"],["class","bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 rounded",4,"ngIf"],["class","bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4 rounded",4,"ngIf"],["class","flex justify-center items-center py-12",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"bg-red-100","border-l-4","border-red-500","text-red-700","p-4","mb-4","rounded"],[1,"bg-green-100","border-l-4","border-green-500","text-green-700","p-4","mb-4","rounded"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-t-2","border-b-2","border-blue-500"],[1,"ml-3","text-gray-600"],[3,"formGroup","ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"col-span-2"],["for","titulo",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","titulo","formControlName","titulo",1,"w-full","px-3","py-2","border","rounded-md","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngClass"],["class","mt-1",4,"ngIf"],["for","descripcion",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","descripcion","formControlName","descripcion","rows","3",1,"w-full","px-3","py-2","border","rounded-md","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500","border-gray-300"],["for","texto_boton",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","texto_boton","formControlName","texto_boton",1,"w-full","px-3","py-2","border","rounded-md","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngClass"],["for","enlace_boton",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","enlace_boton","formControlName","enlace_boton","placeholder","https://ejemplo.com",1,"w-full","px-3","py-2","border","rounded-md","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngClass"],["for","orden",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","number","id","orden","formControlName","orden","min","0",1,"w-full","px-3","py-2","border","rounded-md","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"ngClass"],[1,"flex","items-center","mt-6"],["type","checkbox","id","activo","formControlName","activo",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded"],["for","activo",1,"ml-2","block","text-sm","text-gray-700"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["class","mb-4",4,"ngIf"],[1,"mt-2"],["type","file","id","imagen","accept","image/*",1,"block","w-full","text-gray-500","file:mr-4","file:py-2","file:px-4","file:rounded-md","file:border-0","file:text-sm","file:font-semibold","file:bg-blue-50","file:text-blue-700","hover:file:bg-blue-100",3,"change"],[1,"mt-1","text-sm","text-gray-500"],[1,"mt-8","flex","justify-end","space-x-3"],["type","button",1,"px-4","py-2","bg-gray-100","text-gray-700","rounded-md","hover:bg-gray-200","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-gray-500",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500","disabled:opacity-50","disabled:cursor-not-allowed",3,"disabled"],["class","flex items-center",4,"ngIf"],[4,"ngIf"],[1,"mt-1"],["class","text-red-600 text-sm",4,"ngFor","ngForOf"],[1,"text-red-600","text-sm"],[1,"mb-4"],[1,"relative","max-w-sm"],["alt","Vista previa",1,"rounded-lg","shadow-md","max-h-60","object-contain","bg-gray-100","p-2",3,"src"],["type","button","class","absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600","title","Eliminar imagen seleccionada",3,"click",4,"ngIf"],["type","button","title","Eliminar imagen seleccionada",1,"absolute","top-2","right-2","bg-red-500","text-white","rounded-full","p-1","hover:bg-red-600",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5"],["fill-rule","evenodd","d","M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule","evenodd"],[1,"flex","items-center"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","-ml-1","mr-2","h-4","w-4","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"]],template:function(o,r){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),e._uU(4,"Editar Banner"),e.qZA(),e.TgZ(5,"button",4),e.NdJ("click",function(){return r.cancelar()}),e._uU(6," Volver a la lista "),e.qZA()(),e.YNc(7,p,3,1,"div",5)(8,f,3,1,"div",6)(9,b,4,0,"div",7)(10,U,45,25,"form",8),e.qZA()()),2&o&&(e.xp6(7),e.Q6J("ngIf",r.errorMessage),e.xp6(1),e.Q6J("ngIf",r.successMessage),e.xp6(1),e.Q6J("ngIf",r.isLoadingData),e.xp6(1),e.Q6J("ngIf",!r.isLoadingData&&!r.errorMessage))},dependencies:[d.ez,d.mk,d.sg,d.O5,a.UX,a._Y,a.Fj,a.wV,a.Wl,a.JJ,a.JL,a.qQ,a.sg,a.u]})}return t})()}}]);