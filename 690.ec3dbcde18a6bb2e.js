"use strict";(self.webpackChunkmy_primer_proy_angular=self.webpackChunkmy_primer_proy_angular||[]).push([[690],{2690:(S,m,l)=>{l.r(m),l.d(m,{RegisterComponent:()=>N});var o=l(9212),a=l(6814),i=l(6223),c=l(8432),p=l(131),f=l(4906),d=l(7398);function _(r,t){if(1&r&&(o.TgZ(0,"div",28)(1,"p"),o._uU(2),o.qZA()()),2&r){const n=o.oxw();o.xp6(2),o.Oqu(n.errorMessage)}}function C(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," El nombre es obligatorio. "),o.qZA())}function v(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," El nombre debe tener al menos 3 caracteres. "),o.qZA())}function w(r,t){if(1&r&&(o.TgZ(0,"div",29),o.YNc(1,C,2,0,"div",30)(2,v,2,0,"div",30),o.qZA()),2&r){const n=o.oxw();o.xp6(1),o.Q6J("ngIf",null==n.nameControl||null==n.nameControl.errors?null:n.nameControl.errors.required),o.xp6(1),o.Q6J("ngIf",null==n.nameControl||null==n.nameControl.errors?null:n.nameControl.errors.minlength)}}function h(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," El correo electr\xf3nico es obligatorio. "),o.qZA())}function Z(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," Ingresa un correo electr\xf3nico v\xe1lido. "),o.qZA())}function b(r,t){if(1&r&&(o.TgZ(0,"div",29),o.YNc(1,h,2,0,"div",30)(2,Z,2,0,"div",30),o.qZA()),2&r){const n=o.oxw();o.xp6(1),o.Q6J("ngIf",null==n.emailControl||null==n.emailControl.errors?null:n.emailControl.errors.required),o.xp6(1),o.Q6J("ngIf",null==n.emailControl||null==n.emailControl.errors?null:n.emailControl.errors.email)}}function x(r,t){1&r&&(o.O4$(),o.TgZ(0,"svg",31),o._UZ(1,"path",32)(2,"path",33),o.qZA())}function y(r,t){1&r&&(o.O4$(),o.TgZ(0,"svg",31),o._UZ(1,"path",34),o.qZA())}function T(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," La contrase\xf1a es obligatoria. "),o.qZA())}function A(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," La contrase\xf1a debe tener al menos 8 caracteres. "),o.qZA())}function q(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," La contrase\xf1a debe incluir may\xfasculas, min\xfasculas, n\xfameros y caracteres especiales. "),o.qZA())}function I(r,t){if(1&r&&(o.TgZ(0,"div",29),o.YNc(1,T,2,0,"div",30)(2,A,2,0,"div",30)(3,q,2,0,"div",30),o.qZA()),2&r){const n=o.oxw();o.xp6(1),o.Q6J("ngIf",null==n.passwordControl||null==n.passwordControl.errors?null:n.passwordControl.errors.required),o.xp6(1),o.Q6J("ngIf",null==n.passwordControl||null==n.passwordControl.errors?null:n.passwordControl.errors.minlength),o.xp6(1),o.Q6J("ngIf",null==n.passwordControl||null==n.passwordControl.errors?null:n.passwordControl.errors.pattern)}}function U(r,t){1&r&&(o.O4$(),o.TgZ(0,"svg",31),o._UZ(1,"path",32)(2,"path",33),o.qZA())}function M(r,t){1&r&&(o.O4$(),o.TgZ(0,"svg",31),o._UZ(1,"path",34),o.qZA())}function E(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," Confirma tu contrase\xf1a. "),o.qZA())}function R(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," Las contrase\xf1as no coinciden. "),o.qZA())}function P(r,t){if(1&r&&(o.TgZ(0,"div",29),o.YNc(1,E,2,0,"div",30)(2,R,2,0,"div",30),o.qZA()),2&r){const n=o.oxw();o.xp6(1),o.Q6J("ngIf",null==n.passwordConfirmationControl||null==n.passwordConfirmationControl.errors?null:n.passwordConfirmationControl.errors.required),o.xp6(1),o.Q6J("ngIf",null==n.passwordConfirmationControl||null==n.passwordConfirmationControl.errors?null:n.passwordConfirmationControl.errors.passwordMismatch)}}function F(r,t){1&r&&(o.TgZ(0,"div"),o._uU(1," El rol es obligatorio. "),o.qZA())}function k(r,t){if(1&r&&(o.TgZ(0,"div",29),o.YNc(1,F,2,0,"div",30),o.qZA()),2&r){const n=o.oxw();o.xp6(1),o.Q6J("ngIf",null==n.rolControl||null==n.rolControl.errors?null:n.rolControl.errors.required)}}function J(r,t){1&r&&(o.TgZ(0,"span",35),o.O4$(),o.TgZ(1,"svg",36),o._UZ(2,"circle",37)(3,"path",38),o.qZA()())}const L=r=>({color:r});function Q(r,t){if(1&r&&(o.TgZ(0,"span",35),o.O4$(),o.TgZ(1,"svg",39),o.ALo(2,"async"),o._UZ(3,"path",40),o.qZA()()),2&r){const n=o.oxw();o.xp6(1),o.Q6J("ngStyle",o.VKq(3,L,o.lcZ(2,1,n.colorSecundario)))}}const O=(r,t)=>({"background-color":r,"border-color":t});let N=(()=>{class r{constructor(){this.fb=(0,o.f3M)(i.qu),this.router=(0,o.f3M)(c.F0),this.authService=(0,o.f3M)(p.e),this.configuracionesService=(0,o.f3M)(f.C),this.errorMessage=null,this.showPassword=!1,this.showConfirmPassword=!1,this.isLoading=!1,this.registerForm=this.fb.group({name:["",[i.kI.required,i.kI.minLength(3)]],email:["",[i.kI.required,i.kI.email]],password:["",[i.kI.required,i.kI.minLength(8),i.kI.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/)]],password_confirmation:["",[i.kI.required]],rol:["autor",i.kI.required]},{validators:this.passwordMatchValidator}),this.logoUrl=this.configuracionesService.getImagenUrl("logo_principal"),this.colorPrimario=this.configuracionesService.getAllConfiguraciones().pipe((0,d.U)(n=>n.color_primario||"#3B82F6")),this.colorSecundario=this.configuracionesService.getAllConfiguraciones().pipe((0,d.U)(n=>n.color_secundario||"#10B981")),this.colorGradiente=this.configuracionesService.getAllConfiguraciones().pipe((0,d.U)(n=>{if(n.usar_gradiente&&n.gradiente_colores)try{const s=JSON.parse(n.gradiente_colores);return`linear-gradient(135deg, ${s.inicio||"#4F46E5"}, ${s.fin||"#10B981"})`}catch{return"linear-gradient(135deg, #4F46E5, #10B981)"}return"linear-gradient(135deg, #EBF4FF, #DBEAFE)"}))}ngOnInit(){}passwordMatchValidator(n){const s=n.get("password"),e=n.get("password_confirmation");if(!s||!e)return null;if(s.value!==e.value)return e.setErrors({passwordMismatch:!0}),{passwordMismatch:!0};if(e.errors){const{passwordMismatch:u,...g}=e.errors;e.setErrors(Object.keys(g).length?g:null)}return null}get nameControl(){return this.registerForm.get("name")}get emailControl(){return this.registerForm.get("email")}get passwordControl(){return this.registerForm.get("password")}get passwordConfirmationControl(){return this.registerForm.get("password_confirmation")}get rolControl(){return this.registerForm.get("rol")}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}onSubmit(){this.registerForm.invalid||(this.isLoading=!0,this.errorMessage=null,this.authService.register(this.registerForm.value).subscribe({next:()=>{this.isLoading=!1,this.router.navigate(["/admin/dashboard"])},error:s=>{this.isLoading=!1,console.error("Error al registrar:",s),this.errorMessage=s.error&&s.error.errors?s.error.errors.password?s.error.errors.password[0]:s.error.errors.email?s.error.errors.email[0]:"Error de validaci\xf3n en el formulario.":s.error&&"La direcci\xf3n de correo ya est\xe1 en uso"===s.error.message?"Este correo electr\xf3nico ya est\xe1 registrado. Por favor, utiliza otro o inicia sesi\xf3n.":"Error al crear la cuenta. Por favor, int\xe9ntalo de nuevo."}}))}static#o=this.\u0275fac=function(s){return new(s||r)};static#r=this.\u0275cmp=o.Xpm({type:r,selectors:[["app-register"]],standalone:!0,features:[o.jDz],decls:54,vars:25,consts:[[1,"p-4","flex","justify-center","items-start"],[1,"w-full","max-w-3xl","bg-white","rounded-lg","shadow-lg","p-8","border","border-gray-200"],[1,"mb-6"],[1,"text-2xl","font-bold","mb-2"],[1,"text-gray-600"],["class","bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4 rounded-md","role","alert",4,"ngIf"],[1,"space-y-6",3,"formGroup","ngSubmit"],[1,"space-y-5"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","name","name","name","type","text","formControlName","name","autocomplete","name","required","","placeholder","Tu nombre completo",1,"appearance-none","block","w-full","px-3","py-2.5","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm"],["class","text-xs text-red-500 mt-2 ml-1",4,"ngIf"],["for","email",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","email","name","email","type","email","formControlName","email","autocomplete","email","required","","placeholder","tu.correo@ejemplo.com",1,"appearance-none","block","w-full","px-3","py-2.5","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm"],[1,"relative"],["for","password",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","password","name","password","formControlName","password","autocomplete","new-password","required","","placeholder","********",1,"appearance-none","block","w-full","px-3","py-2.5","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"type"],["type","button",1,"absolute","right-0","top-8","pr-3","flex","items-center","text-sm","leading-5",3,"click"],["xmlns","http://www.w3.org/2000/svg","class","h-5 w-5 text-gray-500","fill","none","viewBox","0 0 24 24","stroke","currentColor",4,"ngIf"],[1,"mt-1","text-xs","text-gray-500"],["for","password_confirmation",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","password_confirmation","name","password_confirmation","formControlName","password_confirmation","autocomplete","new-password","required","","placeholder","********",1,"appearance-none","block","w-full","px-3","py-2.5","border","border-gray-300","placeholder-gray-500","text-gray-900","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm",3,"type"],["for","rol",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","rol","name","rol","formControlName","rol",1,"appearance-none","block","w-full","px-3","py-2.5","border","border-gray-300","text-gray-900","rounded-md","shadow-sm","focus:outline-none","focus:ring-indigo-500","focus:border-indigo-500","sm:text-sm"],["value","autor"],["value","administrador"],[1,"mt-8"],["type","submit",1,"group","relative","w-full","flex","justify-center","py-2.5","px-4","border","border-transparent","text-sm","font-medium","rounded-md","text-white","bg-indigo-600","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500","disabled:opacity-50","disabled:cursor-not-allowed","shadow-sm","transition-colors","duration-200",3,"disabled","ngStyle"],["class","absolute left-0 inset-y-0 flex items-center pl-3",4,"ngIf"],["role","alert",1,"bg-red-100","border-l-4","border-red-500","text-red-700","p-4","mb-4","rounded-md"],[1,"text-xs","text-red-500","mt-2","ml-1"],[4,"ngIf"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","text-gray-500"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"],[1,"absolute","left-0","inset-y-0","flex","items-center","pl-3"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5","group-hover:text-indigo-400",3,"ngStyle"],["fill-rule","evenodd","d","M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z","clip-rule","evenodd"]],template:function(s,e){1&s&&(o.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),o._uU(4,"Registrar nuevo usuario"),o.qZA(),o.TgZ(5,"p",4),o._uU(6," Completa el formulario para crear una nueva cuenta de usuario. "),o.qZA()(),o.YNc(7,_,3,1,"div",5),o.TgZ(8,"form",6),o.NdJ("ngSubmit",function(){return e.onSubmit()}),o.TgZ(9,"div",7)(10,"div")(11,"label",8),o._uU(12,"Nombre completo"),o.qZA(),o._UZ(13,"input",9),o.YNc(14,w,3,2,"div",10),o.qZA(),o.TgZ(15,"div")(16,"label",11),o._uU(17,"Correo electr\xf3nico"),o.qZA(),o._UZ(18,"input",12),o.YNc(19,b,3,2,"div",10),o.qZA(),o.TgZ(20,"div",13)(21,"label",14),o._uU(22,"Contrase\xf1a"),o.qZA(),o._UZ(23,"input",15),o.TgZ(24,"button",16),o.NdJ("click",function(){return e.togglePasswordVisibility()}),o.YNc(25,x,3,0,"svg",17)(26,y,2,0,"svg",17),o.qZA(),o.YNc(27,I,4,3,"div",10),o.TgZ(28,"p",18),o._uU(29," Debe contener al menos 8 caracteres, una may\xfascula, una min\xfascula, un n\xfamero y un caracter especial "),o.qZA()(),o.TgZ(30,"div",13)(31,"label",19),o._uU(32,"Confirmar contrase\xf1a"),o.qZA(),o._UZ(33,"input",20),o.TgZ(34,"button",16),o.NdJ("click",function(){return e.toggleConfirmPasswordVisibility()}),o.YNc(35,U,3,0,"svg",17)(36,M,2,0,"svg",17),o.qZA(),o.YNc(37,P,3,2,"div",10),o.qZA(),o.TgZ(38,"div")(39,"label",21),o._uU(40,"Rol"),o.qZA(),o.TgZ(41,"select",22)(42,"option",23),o._uU(43,"Autor"),o.qZA(),o.TgZ(44,"option",24),o._uU(45,"Administrador"),o.qZA()(),o.YNc(46,k,2,1,"div",10),o.qZA()(),o.TgZ(47,"div",25)(48,"button",26),o.ALo(49,"async"),o.ALo(50,"async"),o.YNc(51,J,4,0,"span",27)(52,Q,4,5,"span",27),o._uU(53),o.qZA()()()()()),2&s&&(o.xp6(7),o.Q6J("ngIf",e.errorMessage),o.xp6(1),o.Q6J("formGroup",e.registerForm),o.xp6(6),o.Q6J("ngIf",(null==e.nameControl?null:e.nameControl.invalid)&&((null==e.nameControl?null:e.nameControl.dirty)||(null==e.nameControl?null:e.nameControl.touched))),o.xp6(5),o.Q6J("ngIf",(null==e.emailControl?null:e.emailControl.invalid)&&((null==e.emailControl?null:e.emailControl.dirty)||(null==e.emailControl?null:e.emailControl.touched))),o.xp6(4),o.Q6J("type",e.showPassword?"text":"password"),o.xp6(2),o.Q6J("ngIf",!e.showPassword),o.xp6(1),o.Q6J("ngIf",e.showPassword),o.xp6(1),o.Q6J("ngIf",(null==e.passwordControl?null:e.passwordControl.invalid)&&((null==e.passwordControl?null:e.passwordControl.dirty)||(null==e.passwordControl?null:e.passwordControl.touched))),o.xp6(6),o.Q6J("type",e.showConfirmPassword?"text":"password"),o.xp6(2),o.Q6J("ngIf",!e.showConfirmPassword),o.xp6(1),o.Q6J("ngIf",e.showConfirmPassword),o.xp6(1),o.Q6J("ngIf",(null==e.passwordConfirmationControl?null:e.passwordConfirmationControl.invalid)&&((null==e.passwordConfirmationControl?null:e.passwordConfirmationControl.dirty)||(null==e.passwordConfirmationControl?null:e.passwordConfirmationControl.touched))),o.xp6(9),o.Q6J("ngIf",(null==e.rolControl?null:e.rolControl.invalid)&&((null==e.rolControl?null:e.rolControl.dirty)||(null==e.rolControl?null:e.rolControl.touched))),o.xp6(2),o.Q6J("disabled",e.isLoading||e.registerForm.invalid)("ngStyle",o.WLB(22,O,o.lcZ(49,18,e.colorPrimario),o.lcZ(50,20,e.colorPrimario))),o.xp6(3),o.Q6J("ngIf",e.isLoading),o.xp6(1),o.Q6J("ngIf",!e.isLoading),o.xp6(1),o.hij(" ",e.isLoading?"Registrando...":"Registrar usuario"," "))},dependencies:[a.ez,a.O5,a.PC,a.Ov,i.UX,i._Y,i.YN,i.Kr,i.Fj,i.EJ,i.JJ,i.JL,i.Q7,i.sg,i.u]})}return r})()}}]);